---
title: "uber"
author: "Valeriy Kondruk"
date: "11 07 2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# UBER perks problem


UBER has introduced the new perks for its drivers recently. One of the perks is the full tuition for the ASU online. Driver needs to make 3000 trips to be able t claim this particular perk. I have a data of a driver who has been driving for 43 weeks. At the time the driver had completed 2091 trips. My goal is to calculate the number of weeks this driver would need to drive to get his ASU Online tuition covered by UBER. 

### Outline the research process

We have a data set covering 43 consequtive weeks of driving history - a sample with 43 observations. Using this sample, we want to make an inference about the population (all possible weeks for this particular driver). 

1. Import and clean data
2. Calculate the descriptive statistics, build the distribution plot
3. Calculate confidence interval
4. Find min and max number of weeks to reach the perk

#### Import and clean data

```{r echo=FALSE, warning=FALSE, results='hide', message=FALSE, error=FALSE}
library(dplyr)
library(ggplot2)
library(readxl)
library(readr)
```

We have already imported the data from Excel file and saved as uber_stats.Rdata file.

```{r uber}
# uber_stats <- read_delim("uber_stats.csv", 
#     ";", escape_double = FALSE, na = "NA", 
#     trim_ws = TRUE)
# View(uber_stats)
# save(uber_stats, file = "uber_stats.Rdata")
load("uber_stats.Rdata")
```

We have the weekly data spanning between September 17, 2018 and July 15, 2019. Data for some of the weeks is unavailable as driver didn't drive those weeks. For this research, we will eliminate the empty weeks.

#### Calculate the descriptive statistics, build the distribution plot

```{r}
trips_stat <- uber_stats %>%
  summarise(trips_mean = mean(as.numeric(uber_stats$`Number of trips`), na.rm = TRUE), trips_sd = sd(as.numeric(uber_stats$`Number of trips`), na.rm = TRUE), trips_min = min(as.numeric(uber_stats$`Number of trips`), na.rm = TRUE), trips_max = max(as.numeric(uber_stats$`Number of trips`), na.rm = TRUE))

paid_weeks <- uber_stats %>%
  filter(!is.na(as.numeric(uber_stats$`Number of trips`)), n())

nonzero_weeks_count <- NROW(paid_weeks$`Number of trips`)

# It's hard to pick the right number of bins for the following histogram, so we're using Sturge's Rule (K = 1 + 3. 322 logN). Where K is nthe number of bins and N is the number of observations.

show(1 + 3.322*log(nonzero_weeks_count))

# We need approximately 13 bins for the plot. We ended up with 8, though.

paid_weeks %>%
  ggplot(aes(as.numeric(paid_weeks$`Number of trips`))) +
  geom_histogram(binwidth = 10)

```

We have a nearly normal distribution with a left skew. The mean is 52.5 and standard deviation is 18.3. We doubt if we should use the Poisson distribution instead as we're dealing with the number of event happening in equal and consequtive periods of time. We keep it normal for now.

#### Calculate confidence interval

We are calculating the confidence interval as (point of estimate +- z*SE).

```{r}
SE_trips <- trips_stat$trips_sd / sqrt(nonzero_weeks_count)
z_trips <- abs(qnorm(0.025))
margin_of_error_trips <- z_trips*SE_trips
ci_trips <- trips_stat %>%
  summarise(lower = trips_mean - margin_of_error_trips, upper = trips_mean + margin_of_error_trips)
```

We found our confidence interval at 95% confidence level to be from `r round(ci_trips$lower, 1)` to `r round(ci_trips$upper, 1)` trips per week.

#### Find min and max number of weeks to reach the perk

```{r}
remaining_weeks_min <- round((3000 - 2091) / ci_trips$upper, 1)
remaining_weeks_max <- round((3000 - 2091) / ci_trips$lower, 1)

```

Considering that the rider already made 2091 trips, it will take this driver at least `r remaining_weeks_min` weeks and at most `r remaining_weeks_max` weeks to reach 3000 trips.
